angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope","UserSvc",function(t,o){t.$on("login",function(o,e){t.currentUser=e}),t.remove=function(e){t.currentUser="",o.logout()}}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc","$location",function(t,o,e){t.login=function(e,n){o.login(e,n).then(function(o){t.$emit("login",o.data)}),document.getElementById("loginform").reset()}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(t,o){t.addPost=function(){t.postBody&&o.create({username:"dickeyxxx",body:t.postBody}).success(function(o){t.postBody=null})},t.$on("ws:new_post",function(o,e){t.$apply(function(){t.posts.unshift(e)})}),o.fetch().success(function(o){t.posts=o})}]),angular.module("app").service("PostsSvc",["$http",function(t){this.fetch=function(){return t.get("/api/posts")},this.create=function(o){return t.post("/api/posts",o)},console.log("Error!")}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(t,o){t.register=function(e,n){o.register(e,n).then(function(o){t.$emit("login",o.data)})}}]),angular.module("app").config(["$routeProvider",function(t){t.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"}).when("/logout",{controller:"ApplicationCtrl",templateUrl:"posts.html"})}]),angular.module("app").service("UserSvc",["$http",function(t){var o=this;o.getUser=function(){return t.get("/api/users")},o.login=function(e,n){return t.post("/api/sessions",{username:e,password:n}).then(function(e){return o.token=e.data,t.defaults.headers.common["X-Auth"]=e.data,o.getUser()})},o.register=function(e,n){return t.post("/api/users",{username:e,password:n}).then(function(){return o.login(e,n)})},o.logout=function(){delete t.defaults.headers.common["X-Auth"],o.getUser()}}]),angular.module("app").run(["$rootScope",function(t){var o="ws://localhost:3010",e=new WebSocket(o);e.onopen=function(){console.log("WebSocket connected")},e.onmessage=function(o){var e=JSON.parse(o.data);t.$broadcast("ws:"+e.topic,e.data)}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyIsIndlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCJVc2VyU3ZjIiwiJG9uIiwiXyIsInVzZXIiLCJjdXJyZW50VXNlciIsInJlbW92ZSIsImxvZ291dCIsIiRsb2NhdGlvbiIsImxvZ2luIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInRoZW4iLCJyZXNwb25zZSIsIiRlbWl0IiwiZGF0YSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJyZXNldCIsIlBvc3RzU3ZjIiwiYWRkUG9zdCIsInBvc3RCb2R5IiwiY3JlYXRlIiwiYm9keSIsInN1Y2Nlc3MiLCJwb3N0IiwiJGFwcGx5IiwicG9zdHMiLCJ1bnNoaWZ0IiwiZmV0Y2giLCJzZXJ2aWNlIiwiJGh0dHAiLCJ0aGlzIiwiZ2V0IiwiY29uc29sZSIsImxvZyIsInJlZ2lzdGVyIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJzdmMiLCJnZXRVc2VyIiwidmFsIiwidG9rZW4iLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJydW4iLCIkcm9vdFNjb3BlIiwidXJsIiwiY29ubmVjdGlvbiIsIldlYlNvY2tldCIsIm9ub3BlbiIsIm9ubWVzc2FnZSIsImUiLCJwYXlsb2FkIiwiSlNPTiIsInBhcnNlIiwiJGJyb2FkY2FzdCIsInRvcGljIl0sIm1hcHBpbmdzIjoiQUFBQUEsUUFBQUMsT0FBQSxPQUNBLFlDREFELFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxtQkFBQSxTQUFBLFVBQUEsU0FBQUMsRUFBQUMsR0FDQUQsRUFBQUUsSUFBQSxRQUFBLFNBQUFDLEVBQUFDLEdB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JywgW1xuXHQnbmdSb3V0ZSdcblxuXHRdKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMpIHtcblx0JHNjb3BlLiRvbignbG9naW4nLCBmdW5jdGlvbiAoXywgdXNlcikge1xuXHRcdCRzY29wZS5jdXJyZW50VXNlciA9IHVzZXJcblx0fSlcblxuICAgJHNjb3BlLnJlbW92ZSA9IGZ1bmN0aW9uKGN1cnJlbnRVc2VyKSB7XG4gICAgICAgICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSAnJztcbiAgICAgICAgICAgIFVzZXJTdmMubG9nb3V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgXHR9KSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMsICRsb2NhdGlvbikge1xuXHQkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG5cdFx0VXNlclN2Yy5sb2dpbih1c2VybmFtZSxwYXNzd29yZClcblx0XHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcblx0XHRcdCRzY29wZS4kZW1pdCgnbG9naW4nLCByZXNwb25zZS5kYXRhKVxuXHRcdH0pXG5cblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ2luZm9ybVwiKS5yZXNldCgpO1xuXHRcdC8vICRsb2NhdGlvbi5wYXRoKCcvJylcblx0XHRcblx0fVxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdQb3N0c0N0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBQb3N0c1N2Yykge1xuXHQkc2NvcGUuYWRkUG9zdCA9IGZ1bmN0aW9uICgpIHtcblx0XHRpZiAoJHNjb3BlLnBvc3RCb2R5KSB7XG5cdFx0XHRQb3N0c1N2Yy5jcmVhdGUoe1xuXHRcdFx0XHR1c2VybmFtZTogJ2RpY2tleXh4eCcsXG5cdFx0XHRcdGJvZHk6ICRzY29wZS5wb3N0Qm9keVxuXHRcdFx0fSkuc3VjY2VzcyhmdW5jdGlvbiAocG9zdCkge1xuXHRcdFx0XHQkc2NvcGUucG9zdEJvZHkgPSBudWxsXG5cdFx0XHR9KVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdCAgJHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbiAoXywgcG9zdCkge1xuICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgJHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdClcbiAgICB9KVxuICB9KVxuXG5cblx0XHRQb3N0c1N2Yy5mZXRjaCgpXG5cdFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKHBvc3RzKSB7XG5cdFx0XHQkc2NvcGUucG9zdHMgPSBwb3N0c1xuXHRcdH0pXG5cdFx0fSkiLCJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1Bvc3RzU3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XG5cdHRoaXMuZmV0Y2ggPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJylcblxuXHR9XG5cdHRoaXMuY3JlYXRlID0gZnVuY3Rpb24gKHBvc3QpIHtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpXG5cdH1cblxuXHRcdFx0Y29uc29sZS5sb2coJ0Vycm9yIScpXG5cdFxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjKSB7XG5cdCRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcblx0XHRVc2VyU3ZjLnJlZ2lzdGVyKHVzZXJuYW1lLHBhc3N3b3JkKVxuXHRcdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXHRcdFx0JHNjb3BlLiRlbWl0KCdsb2dpbicsIHJlc3BvbnNlLmRhdGEpXG5cdFx0fSlcblx0fVxufSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKSB7XG5cdCRyb3V0ZVByb3ZpZGVyXG5cdC53aGVuKCcvJywgeyBjb250cm9sbGVyOiAnUG9zdHNDdHJsJywgdGVtcGxhdGVVcmw6ICdwb3N0cy5odG1sJ30pXG5cdC53aGVuKCcvcmVnaXN0ZXInLCB7IGNvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLCB0ZW1wbGF0ZVVybDogJ3JlZ2lzdGVyLmh0bWwnfSlcblx0LndoZW4oJy9sb2dpbicsIHsgY29udHJvbGxlcjogJ0xvZ2luQ3RybCcsIHRlbXBsYXRlVXJsOiAnbG9naW4uaHRtbCd9KVxuXHQud2hlbignL2xvZ291dCcsIHsgY29udHJvbGxlcjogJ0FwcGxpY2F0aW9uQ3RybCcsIHRlbXBsYXRlVXJsOiAncG9zdHMuaHRtbCd9KVxuXG59KSIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSggJ1VzZXJTdmMnLCBmdW5jdGlvbiAoJGh0dHApIHtcblx0dmFyIHN2YyA9IHRoaXNcblx0c3ZjLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpXG5cdH1cblxuc3ZjLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuXHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zZXNzaW9ucycsIHtcblx0XHR1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZCBcblx0fSkudGhlbihmdW5jdGlvbiAodmFsKSB7XG5cdFx0c3ZjLnRva2VuID0gdmFsLmRhdGFcblx0XHQkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSB2YWwuZGF0YVxuXHRcdHJldHVybiBzdmMuZ2V0VXNlcigpXG5cdH0pXG59XG5cbnN2Yy5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcblx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG5cdFx0dXNlcm5hbWU6IHVzZXJuYW1lLCBwYXNzd29yZDogcGFzc3dvcmQgXG5cdH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiBzdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxuXHR9KVxufVxuXG4gICAgICAgIHN2Yy5sb2dvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGRlbGV0ZSAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ107XG4gICAgICAgICAgICBzdmMuZ2V0VXNlcigpfTtcbn0pXG5cbiAgICAgICAgLy8gY29uc29sZS5sb2coY3VycmVudFVzZXIudXNlcm5hbWUpXG4iLCIvLyBhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi8vIC5ydW4oZnVuY3Rpb24gKCRyb290U2NvcGUsICR0aW1lb3V0KSB7XG4vLyBcdChmdW5jdGlvbiBjb25uZWN0KCkge1xuXG4vLyBcdHZhciB1cmwgPSAnd3M6Ly9sb2NhbGhvc3Q6MzAxMCdcbi8vIFx0dmFyIGNvbm5lY3Rpb24gPSBuZXcgV2ViU29ja2V0KHVybClcblxuLy8gXHRjb25uZWN0aW9uLm9uY2xvc2UgPSBmdW5jdGlvbiAoZSkge1xuLy8gXHRcdGNvbnNvbGUubG9nKCdXZWJTb2NrZXQgY2xvc2VkLiBSZWNvbm5lY3RpbmcgLi4uJylcbi8vIFx0XHQkdGltZW91dChjb25uZWN0LCAxMCoxMDAwKVxuXG4vLyBcdH1cblxuLy8gXHRjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7XG4vLyBcdFx0Y29uc29sZS5sb2coZSlcbi8vIFx0XHR2YXIgcGF5bG9hZCA9IEpTT04ucGFyc2UoZS5kYXRhKVxuLy8gXHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudG9waWMsIHBheWxvYWQuZGF0YSlcbi8vIFx0fVxuLy8gfSlcbi8vIH0pXG5cbi8vV2l0aG91dCB3cmFwcGVyIGZvciByZXN0YXJ0OlxuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5ydW4oZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcbiAgdmFyIHVybCA9ICd3czovL2xvY2FsaG9zdDozMDEwJ1xuICB2YXIgY29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQodXJsKVxuXG4gIGNvbm5lY3Rpb24ub25vcGVuID0gZnVuY3Rpb24gKCkge1xuICAgIGNvbnNvbGUubG9nKCdXZWJTb2NrZXQgY29ubmVjdGVkJylcbiAgfVxuXG4gIGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICB2YXIgcGF5bG9hZCA9IEpTT04ucGFyc2UoZS5kYXRhKVxuICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnd3M6JyArIHBheWxvYWQudG9waWMsIHBheWxvYWQuZGF0YSlcbiAgfVxufSkiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
